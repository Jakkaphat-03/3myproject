<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>แบบสอบถามสุขภาพ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        @import url('https://fonts.googleapis.com/css2?family=Archivo+Black&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Prompt:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap');
        * {
            font-family: 'Prompt', sans-serif;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-100 via-white to-green-100 min-h-screen flex items-center justify-center p-4">

  <form id="healthForm" class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-lg space-y-5 border border-gray-200">
    <h1 class="text-2xl font-bold text-center text-green-700">แบบสอบถามสุขภาพ</h1>

    <!-- อายุ -->
    <div>
      <label class="block font-medium text-gray-700 mb-1">
        อายุ (15-60 ปี) <span class="text-red-500">*</span>
      </label>
      <input type="number" id="age" class="w-full border p-2 rounded focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="กรอกอายุ" />
      <span id="ageError" class="text-red-600 text-sm mt-1 block"></span>
    </div>

    <!-- เพศ -->
    <div>
      <label class="block font-medium text-gray-700 mb-1">เพศ <span class="text-red-500">*</span></label>
      <div class="space-x-4">
        <label><input type="radio" name="gender" value="ชาย" required /> ชาย</label>
        <label><input type="radio" name="gender" value="หญิง" /> หญิง</label>
      </div>
    </div>

    <!-- น้ำหนัก -->
    <div>
      <label class="block font-medium text-gray-700 mb-1">น้ำหนัก (kg) <span class="text-red-500">*</span></label>
      <input type="number" id="weight" class="w-full border p-2 rounded focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="กรอกน้ำหนัก" />
      <span id="weightError" class="text-red-600 text-sm mt-1 block"></span>
    </div>

    <!-- ส่วนสูง -->
    <div>
      <label class="block font-medium text-gray-700 mb-1">ส่วนสูง (cm) <span class="text-red-500">*</span></label>
      <input type="number" id="height" class="w-full border p-2 rounded focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="กรอกส่วนสูง" />
      <span id="heightError" class="text-red-600 text-sm mt-1 block"></span>
    </div>

    <!-- โรคประจำตัว -->
    <div>
      <label class="block font-medium text-gray-700 mb-1">โรคประจำตัว</label>
      <input type="checkbox" id="hasDisease" />
      <label for="hasDisease">มีโรคประจำตัว</label>

      <div id="diseaseDetailContainer" class="mt-3 hidden">
        <textarea id="diseaseDetail" rows="3" class="w-full border p-2 rounded" placeholder="กรอกรายละเอียดโรคประจำตัว..."></textarea>
        <span id="diseaseError" class="text-red-600 text-sm mt-1 block"></span>
      </div>
    </div>

    <!-- ปุ่มส่ง -->
    <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded-md font-semibold">
      ส่งแบบสอบถาม
    </button>
  </form>

  <!-- Modal BMI -->
  <div id="healthModal" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-lg shadow-lg w-80 text-center space-y-4">
      <h2 class="text-xl font-bold text-green-600">✅ ผลการประเมินสุขภาพ</h2>
      <p id="bmiResult" class="text-gray-800"></p>
      <button id="closeHealthModal" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">ปิด</button>
    </div>
  </div>

  <script>
    const form = document.getElementById("healthForm");
    const modal = document.getElementById("healthModal");
    const bmiResult = document.getElementById("bmiResult");
    const closeModal = document.getElementById("closeHealthModal");

    const checkbox = document.getElementById("hasDisease");
    const diseaseContainer = document.getElementById("diseaseDetailContainer");
    const diseaseDetail = document.getElementById("diseaseDetail");

    checkbox.addEventListener("change", () => {
      diseaseContainer.classList.toggle("hidden", !checkbox.checked);
    });

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const age = parseInt(document.getElementById("age").value);
      const weight = parseFloat(document.getElementById("weight").value);
      const height = parseFloat(document.getElementById("height").value);

      let valid = true;

      // เคลียร์ error
      ["ageError", "weightError", "heightError", "diseaseError"].forEach(id => {
        document.getElementById(id).textContent = "";
      });

      //  อายุ
      if (isNaN(age) || age < 15 || age > 60) {
        document.getElementById("ageError").textContent = "อายุควรอยู่ระหว่าง 15-60 ปี";
        valid = false;
      }

      //  น้ำหนัก
      if (isNaN(weight) || weight <= 0) {
        document.getElementById("weightError").textContent = "น้ำหนักต้องมากกว่า 0";
        valid = false;
      }

      //  ส่วนสูง
      if (isNaN(height) || height <= 0) {
        document.getElementById("heightError").textContent = "ส่วนสูงต้องมากกว่า 0";
        valid = false;
      }

      //  โรคประจำตัว
      if (checkbox.checked && diseaseDetail.value.trim() === "") {
        document.getElementById("diseaseError").textContent = "กรุณาระบุรายละเอียดโรคประจำตัว";
        valid = false;
      }

      // คำนวณ BMI
      if (valid) {
        const bmi = weight / Math.pow(height / 100, 2);
        let category = "";

        if (bmi < 18.5) category = "น้ำหนักน้อย";
        else if (bmi < 25) category = "ปกติ";
        else if (bmi < 30) category = "น้ำหนักเกิน";
        else category = "อ้วน";

        bmiResult.textContent = `BMI ของคุณคือ: ${bmi.toFixed(2)} (${category})`;
        modal.classList.remove("hidden");
      }
    });

    closeModal.addEventListener("click", () => modal.classList.add("hidden"));
    modal.addEventListener("click", e => {
      if (e.target === modal) modal.classList.add("hidden");
    });
  </script>
</body>
</html>
